!function(t,e){"function"==typeof define?define("/static/common/mod/calendar/calendar.js",function(t){return e(t("common:jquery"),t("common:util"))}):(t.FeatherUi=t.FeatherUi||{},t.FeatherUi.Calendar=e(t.jQuery||t.$,t.FeatherUi.Util))}(window,function(t,e){var a=e.string.toPad,n=document,r=function(e){this.options=t.extend({container:n.body,target:null,handle:null,maxDate:null,minDate:null,yearRange:null,dateFormat:"Y-m-d",callback:function(){},onSelect:function(){this.close()}},e||{}),this.init()};return r.prototype={init:function(){var e=this,a=e.options;e.options.target&&(e.target=t(e.options.target)),e.wraper=t('<div class="ui-calendar"></div>'),e.container=t(e.options.container).append(e.wraper),e.container[0]==n.body&&e.wraper.css("position","absolute"),a.minDate&&(e.minDate="string"==typeof a.minDate?a.minDate:e.getDate(a.minDate)),a.maxDate&&(e.maxDate="string"==typeof a.maxDate?a.maxDate:e.getDate(a.maxDate)),e.toMonth(),e.bindEvent(),e.close()},bindEvent:function(){var e=this,a=e.options,n=a.handle?t(a.handle):e.target;n&&n.click(function(){e.open(),e.resetPosition()}),t(window).on("resize scroll",function(){e.resetPosition()});var r=n[0];t(document).click(function(t){t.target!=r&&e.close()}),e.wraper.click(function(n){var r=t(n.target);if(r.hasClass("ui-calendar-prev"))e.prevMonth();else if(r.hasClass("ui-calendar-next"))e.nextMonth();else if(r.hasClass("ui-calendar-item")&&!r.hasClass("ui-calendar-item-disable")){var i=r.attr("data-calendar-date");a.onSelect&&a.onSelect.call(e,i),e.target&&e.target.val(i).html(i)}n.stopPropagation()}),e.wraper.delegate(".ui-calendar-year-select","change",function(){e.toMonth(this.value)}),e.wraper.delegate(".ui-calendar-month-select","change",function(){e.toMonth(e.year,this.value)})},prevMonth:function(){this.toMonth(this.year,this.month-1)},nextMonth:function(){this.toMonth(this.year,this.month+1)},toMonth:function(t,e){var a=this,n=new Date;t&&n.setFullYear(t),null!=e&&(n.setDate(1),n.setMonth(e)),a.year=n.getFullYear(),a.month=n.getMonth(),a.createCalendar(),a.options.callback&&a.options.callback.call(a),a.resetPosition()},createCalendar:function(){var e=this;e.wraper.find(".ui-calendar-container").remove(),t('<table class="ui-calendar-container" />').appendTo(e.wraper).append(e.createCalendarHeader(),e.createCalendarItems())},createCalendarItems:function(){for(var t=this,e=(t.options,new Date(t.year,t.month,1)),a=new Date(t.year,t.month+1,0),n=t.getDate(new Date),r=e.getDay(),i=a.getDate(),o=Math.ceil((r+i)/7),s=[],l=1,c=0;o>c;c++){for(var h=[],d=0;7>d;d++)if(r>d&&0==c||l>i)h.push("<td>&nbsp;</td>");else if(i>=l){var u=t.getDate(new Date(t.year,t.month,l)),p="ui-calendar-item";n==u&&(p+=" ui-calendar-item-today"),(t.minDate&&u<t.minDate||t.maxDate&&u>t.maxDate)&&(p+=" ui-calendar-item-disable"),h.push('<td><a href="javascript:" data-calendar-date="'+u+'" class="'+p+'">'+l++ +"</a></td>")}s.push("<tr>"+h.join("")+"</tr>")}return"<tbody>"+s.join("")+"</tbody>"},createCalendarHeader:function(){var e,n=[],i=this,o=i.options.yearRange;if(o){o=o.split(":"),e='<select class="ui-calendar-year-select">';for(var s=Math.min(i.year,o[0]),l=Math.max(i.year,o[1]);l>=s;s++)e+='<option value="'+s+'" '+(i.year==s?"selected":"")+">"+s+"年</option>";e+='</select><select class="ui-calendar-month-select">';for(var c=0;12>c;c++)e+='<option value="'+c+'" '+(i.month==c?"selected":"")+">"+a(c+1,0,2,!0)+"月</option>";e+="</select>"}else e=i.year+"."+a(i.month+1,0,2,!0);return t.each(r.WEEKNAME,function(t,e){n.push("<th>"+e+"</th>")}),["<thead>",'<tr class="ui-calendar-title">','<th colspan="7">',o?"":'<a href="javascript:" class="ui-calendar-next"></a>',o?"":'<a href="javascript:" class="ui-calendar-prev"></a>','<span class="ui-calendar-date">'+e+"</span>","</th>","</tr>","<tr>"+n.join("")+"</tr>","</thead>"].join("")},open:function(){this.wraper.show(),this.resetPosition()},close:function(){this.wraper.hide()},resetPosition:function(){if(this.target){var e,a=this,r=a.target.offset(),i=n.body.scrollTop||n.documentElement.scrollTop;e=i+t(window).height()<r.top+a.wraper.outerHeight()?r.top-a.wraper.outerHeight()-1:r.top+a.target.outerHeight()+1,a.wraper.css({left:r.left,top:e})}},getDate:function(t){return e.date.date(this.options.dateFormat,t.getTime())}},r.WEEKNAME=["日","一","二","三","四","五","六"],r});